!function(e){var o=e.module("moviecat",["moviecat_home","moviecat_details","moviecat_movie_list"]);o.directive("hmActive",function(){return{restrict:"A",link:function(e,o,t){o.on("click",function(){o.parent().children().removeClass("active"),o.addClass("active")})}}}),o.controller("searchCtrl",["$scope","$window",function(e,o){e.query=function(){var t=e.keyword;o.location.hash="#/search?q="+t}}])}(angular),function(e){var o=e.module("moviecat_home",["ngRoute"]);o.config(["$locationProvider",function(e){e.hashPrefix("")}]),o.config(["$routeProvider",function(e){e.when("/home",{templateUrl:"./home/home.html"}).when("/",{redirectTo:"/home"})}])}(angular),function(e){var o=e.module("moviecat_details",["ngRoute","heima"]);o.config(["$routeProvider",function(e){e.when("/details/:id",{templateUrl:"./details/details.html",controller:"detailsCtrl"})}]),o.controller("detailsCtrl",["$scope","$routeParams","heimaJsonp",function(e,o,t){e.isShow=!0;var a=o.id;t.hmJsonp({url:"http://api.douban.com/v2/movie/subject/"+a,params:{},callback:function(o){e.movie=o,e.isShow=!1,e.$apply()}})}])}(angular),function(e){var o=e.module("moviecat_movie_list",["ngRoute","heima"]);o.config(["$routeProvider",function(e){e.when("/:type/:page?",{templateUrl:"./movie_list/movie_list.html",controller:"movie_listCtrl"})}]),o.controller("movie_listCtrl",["$scope","heimaJsonp","$window","$routeParams","$route",function(e,o,t,a,i){e.isShow=!0,e.pageIndex=(a.page||1)-0,e.pageSize=10,o.hmJsonp({url:"http://api.douban.com/v2/movie/"+a.type,params:{count:e.pageSize,start:(e.pageIndex-1)*e.pageSize,q:a.q},callback:function(o){e.movies=o,e.pageCount=t.Math.ceil(o.total/e.pageSize),e.isShow=!1,e.$apply()}}),e.getPage=function(o){o<1||o>e.pageCount||i.updateParams({page:o})}}])}(angular),function(e){e.module("heima",[]).service("heimaJsonp",["$window",function(e){this.hmJsonp=function(o){var t=o.url+"?";for(var a in o.params)t+=a+"="+o.params[a]+"&";var i="hmjsonp_"+e.Math.random().toString().slice(2);e[i]=o.callback,t+="callback="+i;var n=e.document.createElement("script");n.src=t,e.document.body.appendChild(n)}}])}(angular);